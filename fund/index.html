---
---
<!DOCTYPE html>
<html lang=en>
<head>
    {% include meta.html %}
    <link rel="stylesheet" type="text/css" href="../css/style.css"/>
    <link rel="stylesheet" type="text/css" href="./fund.css"/>

    <script src="https://js.braintreegateway.com/web/dropin/1.32.1/js/dropin.min.js"></script>

    <title>Fund | Brains@Play</title>
</head>
<body>
<!-- <div id=app> -->
    <!--Navbar-->
    {% include nav.html %}

    <div id="fund-header" class="header new">
        <h2>Fund</h2>
    </div>

    <!--Content-->
<section id="futures">
    <div id="fund-info">
        <div>
            <span id="fund-total"><span id="fund-total-current">$0</span> USD / month</span>
            <p id="fund-latest-contributor" style="opacity: 0; transition: 0.5s;"><small><span id="fund-latest-contributor-name"></span> <span id="fund-latest-contributor-action"></span>!</small></p>
        </div>

        <div>
            {% include feed.html %}
        </div>
    </div>

    <h2>About the Fund</h2>
    <hr>
    <p><small>
        All the funds raised here are helping to support Brains@Play's technology development 
        and allow us to focus our efforts wholeheartedly towards releasing open-source brain and 
        biomedical sensing infrastructure.
    </small></p>

    {% include projects.html %}

    <!-- {% include feed.html %} -->

    <p><small>
        Thank you!
    </small></p>

    <small style="opacity: 0.5;">
        â€” Garrett, Josh, and Jacob
    </small>

    <div id="contribution-header">
        <h2>Select a Contribution</h2>
    </div>
    <hr>
    <div class="form-container">
        <div class="form-context">
            <div class='flex'>
                <form  id="contributor-info-form" class="form" action="">
                    <div class="login-element">
                        <input type="text" name="displayName" autocomplete="off" placeholder="Display Name"/>
                    </div>
                    <div class="login-element">
                        <input type="text" name="contributionNote" autocomplete="off" placeholder="Contribution Note"/>
                    </div>
                    <div class="login-element">
                        <input type="text" name="discordId" autocomplete="off" placeholder="Discord ID (optional)"/>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div id="fund-contribution-amounts">
        <div data-amount="5">
            <p>$5 USD</p>
        </div>
        <div data-amount="10">
            <p>$10 USD</p>
        </div>
        <div data-amount="20">
            <p>$20 USD</p>
        </div>
        <div data-amount="50">
            <p>$50 USD</p>
        </div>
        <div data-amount="250">
            <p>$250 USD</p>
        </div>
        <div data-amount="1000">
            <p>$1000 USD</p>
        </div>
        <div data-amount="5000">
            <p>$5000 USD</p>
        </div>
        <div id="custom">
            <p>$<input id="custom-contribution-amount" type="number"></input> USD</p>
        </div>
    </div>

    <br>

    <div id="dropin-container"></div>
    <br>

    <div id="checkout-container">
        <button id="submit-button">
            <div>
                <span>Fund!</span>
                <br/>
                <span class="small">Secured by Stripe</span>
            </div>
        </button>
        <div>
            <label class="switch">
                <input type="checkbox">
                <span class="slider round"></span>
            </label>
            <small id="contribution-type">Monthly</small>
        </div>
    </div>
    
    <div class="notification">
        <h4 id="error-action"></h4>
        <p><strong><span id="error-name"></span>:</strong> <span id="error-response"></span></p>
    </div>

</section>

    <!--Footer-->
    {% include footer.html %}

<!-- </div> -->

</body>

<script src="./stripe.js" type="text/javascript"></script>

<script>

// Globals to Manage (and remove eventually...)
let selectedContribution
let recurring = true

const button = document.querySelector('#submit-button');
button.onclick = () => {

    // Get Custom Fields for Form
    let form = document.getElementById('contributor-info-form')
    let formDict = {metadata: {}, recurring}
    let formData = new FormData(form);
    for (var pair of formData.entries()) {
        formDict.metadata[pair[0]] = pair[1];
    }

    formDict.amount = selectedContribution

    // Trigger Stripe Action
    contributeToFund(formDict)

}

</script>

<!-- <script src="./payment.js" type="text/javascript"></script> -->
<script src="./total.js" type="text/javascript"></script>
<script src="./monthly.js" type="text/javascript"></script>
<script src="./custom.js" type="text/javascript"></script>

</html>
